# ゴルフオリンピック スコアアプリ 使い方ガイド

## 📱 アプリについて

ゴルフオリンピックは、ゴルフのラウンドスコアをメダル形式（金・銀・銅・鉄・ダイヤモンド）で管理し、リアルタイムで同伴プレイヤーとスコアを共有できるPWAアプリです。

**主な機能：**
- ⛳ ホールごとのスコア入力（メダル形式）
- 🏅 リアルタイムスコア集計
- 🔄 Firebase経由のリアルタイム同期
- 👥 複数プレイヤー対応（最大4人）
- 📊 スコア一覧・履歴管理
- ☁️ クラウドバックアップ

---

## 🚀 はじめに

### アクセス方法

**ブラウザ版：**
```
https://guncys-inc.github.io/olympic_score/
```

**PWAインストール（推奨）：**

**iPhone/iPad:**
1. Safariで上記URLを開く
2. 共有ボタン → 「ホーム画面に追加」
3. 「追加」をタップ

**Android:**
1. Chromeで上記URLを開く
2. メニュー → 「ホーム画面に追加」
3. 「追加」をタップ

---

## 🎮 基本的な使い方

### 1. ラウンドの開始

#### パターンA: 新規ラウンドを作成

1. **設定画面**から `🆕 新規作成` をタップ
2. 新しいラウンドIDが自動生成される（例：`round_1765699497189`）
3. ラウンドIDをコピーして同伴プレイヤーにLINEなどで共有

**ラウンドID共有例：**
```
今日のラウンドID：
round_1765699497189

このIDでアプリから参加してください！
```

#### パターンB: 既存ラウンドに参加

1. **設定画面**から `🔗 参加` をタップ
2. 共有されたラウンドIDを入力
3. `参加` ボタンをタップ
4. ✅ 参加完了（リアルタイム同期開始）

---

### 2. プレイヤー設定

1. **設定画面**を開く
2. **プレイヤー名**を入力（デフォルト：P1, P2, P3, P4）
3. **アバター**をタップして好きなアバターを選択

**アバター選択：**
- 30種類のアバターから選択可能
- 5x6グリッドで一覧表示

---

### 3. コース設定

1. **設定画面**で以下を入力：
   - **ゴルフ場名**（例：千葉カントリークラブ）
   - **プレイ日**（自動で今日の日付が入力される）

2. **プリセット**から保存済み設定を読み込むことも可能

---

### 4. スコア入力

#### 入力画面の使い方

1. **ホール**を選択（1〜18）
2. **プレイヤー**を選択（P1〜P4）
3. **メダル・スコア**をタップして入力

**メダル（ランク系）：**
- 🥇 金メダル（+3点）
- 🥈 銀メダル（+2点）
- 🥉 銅メダル（+1点）
- ⚫ 鉄メダル（0点）
- 💎 ダイヤモンド（+5点）

**※ ランク系は1つだけ選択可能**

**追加スコア（複数選択可）：**
- 🎯 ニアピン（+1点）
- 🏌️ ドラコン（+1点）
- 🦅 イーグル（+3点）
- 🐦 バーディー（+1点）
- ⛳ 旗を立てたまま（+1点）
- 🏖️ バンカー（-1点）
- ❌ 3パット（-1点）

**入力例：**
```
ホール1、P1が「金メダル + バーディー + ニアピン」
→ 3 + 1 + 1 = 5点
```

---

### 5. スコア確認

#### 一覧画面

1. 画面下部のナビゲーションから `🏆 一覧` をタップ
2. 全プレイヤーのスコアを一覧表示
3. **各ホールごとの詳細**が確認可能

**表示内容：**
- ホールごとのメダル種類
- 追加スコア（アイコン表示）
- 各ホールの合計点数
- 累計スコア

---

### 6. リアルタイム同期

**自動同期：**
- スコア入力後、自動的にFirebaseに保存
- 同じラウンドIDを使用している全プレイヤーに即座に反映

**同期状態の確認：**
- コンソールログ（デバッグ用）に「Firebase保存完了」と表示
- 他のプレイヤーの入力が1〜2秒以内に反映される

**オフライン時：**
- LocalStorageにデータが保存される
- オンライン復帰時に自動同期

---

## 📂 ラウンド管理

### ラウンドの切り替え

1. **設定画面** → `📂 ラウンド管理`
2. 過去のラウンド一覧が表示される
3. `📥 読込` をタップして切り替え

**視覚的区別：**
- 🔗 **青色**：参加したラウンド（他の人が作成）
- 📝 **緑色**：自分で作成したラウンド

### ラウンドの削除

1. **設定画面** → `📂 ラウンド管理`
2. 削除したいラウンドの `🗑` ボタンをタップ
3. 確認ダイアログで「OK」

**※ LocalStorageからのみ削除（Firebaseには残る）**

---

## 🔐 管理者モード（Firebase管理）

### 管理者モードの起動

**URL:**
```
https://guncys-inc.github.io/olympic_score/?admin=1
```

**初回：**
1. 「管理者パスワードを設定してください」と表示
2. パスワードを入力（例：`golf2024`）
3. パスワードがブラウザに保存される

**2回目以降：**
1. 「管理者パスワードを入力してください」と表示
2. 設定したパスワードを入力
3. 認証成功 → 管理者モードで起動

### Firebase管理

**アクセス：**
1. 管理者モードで起動
2. **設定画面** → `📂 ラウンド管理` → `☁️ Firebase管理`

**機能：**
- 📋 Firebase上の全ラウンドを一覧表示
- 🗑 不要なラウンドを削除（全プレイヤーから削除）
- 🔄 最新データを取得

**表示情報：**
- ゴルフ場名
- プレイ日
- プレイヤー数
- 最終更新日時
- ラウンドID

**注意：**
⚠️ ここから削除すると、Firebaseから完全に削除されます。参加者全員がアクセスできなくなります。

### パスワードリセット

パスワードを忘れた場合：
1. ブラウザのコンソール（F12）を開く
2. 以下を実行：
   ```javascript
   localStorage.removeItem('admin_password')
   ```
3. ページをリロード
4. 新しいパスワードを設定

---

## 🎯 高度な機能

### プリセット設定の保存

1. **設定画面**で各種設定を入力
2. `💾 プリセット保存` をタップ
3. プリセット名を入力（例：「千葉CC 通常設定」）
4. 次回から `📋 プリセット` から呼び出し可能

### スコアポイントのカスタマイズ

1. **設定画面**の各メダル・スコアの数値を変更
2. 例：金メダルを5点に変更
3. 変更は即座に反映される

### Google Sheetsバックアップ（オプション）

1. **設定画面** → `☁️ Google Sheets API 設定`
2. Google Apps ScriptのWebアプリURLを入力
3. スコアが自動的にGoogle Sheetsにもバックアップされる

**セットアップ手順：**
詳細は `sheets-setup.md` を参照

---

## 🐛 デバッグ・トラブルシューティング

### デバッグログの確認

**モバイル（iPhone/Android）：**
1. `🔗 参加` モーダルを開く
2. 画面下部に「📋 デバッグログ」が表示される
3. 最新20件のログが確認可能

**ログ例：**
```
[17:05:23] 参加開始: round_xxxxx
[17:05:23] ✅ Firebase OK
[17:05:23] Firebase読み込み開始
[17:05:24] Snapshot取得: データあり
[17:05:24] ✅ データ読込成功
[17:05:24] ✅ 参加完了
```

### よくある問題

#### 1. 参加ボタンが反応しない

**原因：** Firebase未初期化

**解決策：**
- ページを完全リロード（Ctrl+Shift+R または Cmd+Shift+R）
- 数秒待ってから再度試す
- デバッグログで「Firebase未初期化」を確認

#### 2. スコアが同期されない

**原因：** リアルタイム同期が開始されていない

**解決策：**
- ラウンドIDが正しいか確認
- 一度ラウンドを再読込
- Firebaseコンソールでデータを確認

#### 3. 前回のラウンドが復元されない

**原因：** LocalStorageがクリアされた

**解決策：**
- `📂 ラウンド管理` から手動で読込
- Firebaseに保存されていれば、ラウンドIDで再参加

---

## 💾 データの保存・同期

### 3層バックアップシステム

1. **Firebase Realtime Database**（メイン）
   - リアルタイム同期
   - 複数デバイス間で共有

2. **LocalStorage**（ローカル）
   - オフライン時のバックアップ
   - 高速読み込み

3. **Google Sheets**（オプション）
   - 長期保存用
   - CSV出力・分析用

### データの永続性

- **ページリロード**：データは保持される（LocalStorageから復元）
- **ブラウザキャッシュクリア**：Firebaseから再取得可能
- **デバイス変更**：ラウンドIDで参加すれば同じデータにアクセス

---

## 🔒 セキュリティ・プライバシー

### Firebase APIキー

- APIキーはコードに含まれていますが、**公開前提の設計**です
- セキュリティはFirebase Database Rulesで制御
- 不正アクセスは防止されています

### データの可視性

- **誰でも読み込み可能**：ラウンドIDを知っていれば参加可能
- **誰でも書き込み可能**：参加者は誰でもスコア入力可能
- **削除は管理者のみ**：管理者モード + パスワードが必要

---

## 📞 サポート・フィードバック

### GitHub

リポジトリ：https://github.com/guncys-inc/olympic_score

### 機能リクエスト・バグ報告

GitHubのIssuesで受け付けています。

---

## 📝 更新履歴

### v2.0.0（最新）
- ✅ Firebase Realtime Database統合
- ✅ リアルタイム同期機能
- ✅ 参加/作成ラウンドの視覚的区別
- ✅ ラウンドキャッシュ機能
- ✅ デバッグログ表示
- ✅ 管理者モード追加
- ✅ 起動時の自動ラウンド作成を停止

### v1.0.0
- ✅ 基本的なスコア入力機能
- ✅ メダルシステム
- ✅ Google Sheetsバックアップ
- ✅ PWA対応

---

## 🎓 用語集

| 用語 | 説明 |
|------|------|
| **ラウンドID** | 各ラウンドを識別する一意のID（例：round_1765699497189） |
| **Firebase** | Googleが提供するリアルタイムデータベースサービス |
| **PWA** | Progressive Web App（インストール可能なWebアプリ） |
| **LocalStorage** | ブラウザのローカルストレージ |
| **リアルタイム同期** | データ変更が即座に全デバイスに反映される機能 |
| **管理者モード** | Firebase管理権限を持つ特別モード |
| **プリセット** | よく使う設定を保存・呼び出しできる機能 |

---

## 📱 推奨環境

- **iOS**: iOS 14以降（Safari、Chrome）
- **Android**: Android 8以降（Chrome）
- **PC**: Chrome、Edge、Safari最新版

---

以上でゴルフオリンピックアプリの使い方ガイドは終了です。
楽しいゴルフライフをお過ごしください！⛳✨
